<!DOCTYPE html>
<html>
<head>
    <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet">
    <title>Analysis Results</title>
</head>
<body>
    <header>
        <h1>Track Analysis</h1>
    </header>
    <div class="main-page">
        <div class="title">
            <h2> Predictions for:</h2>
            <h3> {{filename}}</h3>
        </div>
        <div class="predictions">
            <div class="genrePredictions">
                <h3>Genre Predictions:</h3>
                <ol>
                    {% for genre, (probability) in genres.items() %}
                        <li>{{ genre }}, Confidence: {{ probability }}%</li>
                    {% endfor %}
                </ol>            
            </div>
            <div class="featurePredictions">
                <h3>Feature Predictions:</h3>
                <ol>
                    {% for feature, (score) in features.items() %}
                        <li>{{ feature }}: {{ score }}</li>
                    {% endfor %}
                </ol>            
            </div>
        </div>
        <div class="feature_graph">
            <img src="data:image/png;base64,{{ feature_plot_url }}" alt="Audio features over time">
        </div>
        <div class="track_recomendations">
            <h2>Closest Tracks</h2>
            <p>These are the closest tracks to yours from our database</p>
            <ul>
                {% for track in nearest_track_info %}
                            <li>
                                <p>{{ track[0] }}</p> 
                                {% if track[2] %} <p>Artist: </p> <a href="{{ track[2] }}">{{ track[1] }}</a>
                                {% else %} <p>Artist: {{ track[1] }}</p>
                                {% endif %}
                                {% if track[4] %} <p>Album: </p> <a href="{{ track[4] }}">{{ track[3] }}</a> 
                                {% else %} <p>Album: {{ track[3] }}</p>
                                {% endif %}
                            </li>
                {% endfor %}
            </ul>
        </div>
        <div class="resultGraphs">
            <div class="genre_bar">
                <div class="graph-info">
                    <h3>Graph of top genres</h3>
                </div>
                <img src="data:image/png;base64,{{ genre_plot_url }}" alt="Bar Graph of genres">
            </div>
            <div class="mel_spec">
                <div class="graph-info">
                    <h3>Mel Spectrogram</h3>
                    <p>This is part of what is used for analysis</p>
                </div>
                <img src="{{ url_for('static', filename='images/' + file_id + '.png') }}" alt="Mel Spectrogram">
            </div>
        </div>
    </div>
</body>
</html>
